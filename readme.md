# Simple Note Taker application

This application consists of two portions, the back-end API and the front-end. 

Upon logging in, the user will be presented with a collection of notes that they have created, similar to a set of sticky notes.


## Database setup

In a blank mySQL database, run the following database creation script. Replace `[database]` with the desired database name.

```
use [database];

CREATE TABLE `users` (
  `id` bigint(64) NOT NULL AUTO_INCREMENT,
  `name` varchar(255) NOT NULL,
  `email` varchar(255) NOT NULL,
  `password` varchar(255) NOT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `email` (`email`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `notes` (
  `note_id` bigint(64) NOT NULL AUTO_INCREMENT,
  `user_id` bigint(64) NOT NULL,
  `title` varchar(255) NOT NULL,
  `content` text NOT NULL,
  `deleted` boolean,
  `updated_at` timestamp NULL DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`note_id`),
  FOREIGN KEY (user_id)
        REFERENCES users(id)
        ON DELETE CASCADE
) ENGINE=InnoDB;

INSERT INTO users
(id, name, email, password, updated_at, created_at)
VALUES
(1, 'test', 'test@test.com', '$2y$10$Q7hi.IQlFFY3A96BJveDtOPQ9Nf40i2Vf4QV0g8IoDYA8RZtgTD06',
'2015-10-12 02:40:15', '2015-10-12 02:40:15');

CREATE TABLE `tokens` (
  `user_id` bigint(64) NOT NULL,
  `token_value` varchar(255) NOT NULL,
  `deleted` boolean DEFAULT false,
  `expires_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`token_value`),
  FOREIGN KEY (user_id)
        REFERENCES users(id)
        ON DELETE CASCADE
) ENGINE=InnoDB

```

This will create three tables, as well as populate the Users table with a single user.
A service account should be created within the database with `INSERT`, `UPDATE`, and `SELECT` permissions on all three tables

## Back-end configuration

The back-end is built on the Lumen PHP framework and requires some configuration to connect to the database.
Create (or update) the `.env` file with appropriate DB_CONNECTION, DB_HOST, DB_PORT, DB_DATABASE, DB_USERNAME, and DB_PASSWORD values.

If being deployed on a server (and not a local machine using default settings), change APP_URL to the desired location.
For local testing, PHP has a built in webserver.

To run this server, enter the following command at the application root within a Bash shell

`php -S localhost:8000 -t public`

## Front-end configuration

The front-end is located within the `frontend` directory and contains a simple application written using AngularJS to interact with the API. Like the back-end, it can be run directly from the filesystem or by using a simple webserver.

It must be configured to point to the correct location of the back-end by editing the value of `API-URL` in `app.js`

Assuming that Python 3 is installed, run
`python3 -m http.server 8079` to start the web server.

Note that the port number is different - this is to prevent conflicts with the back-end when running on the same machine.


## Other notes

- The API uses simple tokens for authentication. These are generated by the API and stored by the client in Javascript local storage. When a user logs out, the API invalidates the token and the front-end will erase its local copy.

- CORS may cause problems with API communication. To allow local testing, the `CorsMiddleware` file contains the desired settings

- There may be some CSS glitching in the front-end, but since I am not the creative type, my focus has been on making something that works.

- Ideally there would be unit tests for each of the API endpoints that would test the following
-- Log on and log off with good and bad credentials
-- Retrieve, update, and delete notes
-- Attempting to modify another user's notes
